FROM eclipse-temurin:17-jdk-focal as build

# Work work work!
WORKDIR /work
COPY ./Grasscutter Grasscutter
COPY ./VERSION Grasscutter

# Building Grasscutter Source
RUN \
    cd Grasscutter && version=$(cat VERSION) && echo update: $version t6 && ls -a &&\
    # Run it :)
    chmod +x gradlew && ./gradlew jar && \
    # We delete it because it is only needed during building process.
    ls -a && rm -R -f build build.gradle gradle gradlew lib proto settings.gradle src sync.sh &&\
    cp grasscutter-*.jar grasscutter.jar && rm grasscutter-*.jar && ls -a