FROM eclipse-temurin:17-jdk-alpine
RUN  \
     # Install json utilities for config.json
     apk add --no-cache npm git curl gcompat &&\
     npm install --unsafe-perm -g json

# Sweet Home Alabama :)
WORKDIR /home

# EXPOSE Web (https) and Game Server
EXPOSE 443 22102

RUN addgroup --system dockergc && adduser -S -s /bin/false -G dockergc dockergc

# Copy files Grasscutter
COPY work ./Grasscutter
COPY entrypoint.sh ./Grasscutter
RUN chown -R dockergc:dockergc ./Grasscutter

USER dockergc

ENTRYPOINT ["sh", "./Grasscutter/entrypoint.sh"]